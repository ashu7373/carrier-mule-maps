%dw 2.0
import java!com::conversion::HtmlToJson
output application/json
var data = (read(HtmlToJson::htmlToJson(payload as String),"application/json"))[ 0 to -1]
---

data default [] map {
	(externalId: lower(trim($."Klantnummer")) as String default "") if !(isEmpty(trim($."Klantnummer"))),
	(identifier1: trim($."Uw referentie") as String default "") if !(isEmpty(trim($."Uw referentie"))),
	(statusCode: if(trim($."Motief") as String contains "XB") "CA"
else if(trim($."Motief") as String contains "AN") "AF"
else if(trim($."Motief") as String contains "TI") "AF"
else if(trim($."Motief") as String contains "LA") "D1"
else if(trim($."Motief") as String contains "LB") "D1"
else if(trim($."Motief") as String contains "LC") "D1"
else if(trim($."Motief") as String contains "LE") "D1"
else if(trim($."Motief") as String contains "LH") "D1"
else if(trim($."Motief") as String contains "LI") "D1"
else if(trim($."Motief") as String contains "LM") "D1"
else if(trim($."Motief") as String contains "LN") "D1"
else if(trim($."Motief") as String contains "LO") "D1"
else if(trim($."Motief") as String contains "LP") "D1"
else if(trim($."Motief") as String contains "LR") "D1"
else if(trim($."Motief") as String contains "LS") "D1"
else if(trim($."Motief") as String contains "LX") "D1"
else if(trim($."Motief") as String contains "XD") "CA"
else if(trim($."Motief") as String contains "XE") "CA"
else if(trim($."Motief") as String contains "XF") "CA"
else if(trim($."Motief") as String contains "XV") "CA"
else if(trim($."Motief") as String contains "XW") "CA"
else if(trim($."Motief") as String contains "XX") "CA"
else if(trim($."Motief") as String contains "AI") "A9"
else if(trim($."Motief") as String contains "AM") "A9"
else if(trim($."Motief") as String contains "AP") "A9"
else if(trim($."Motief") as String contains "AQ") "A9"
else if(trim($."Motief") as String contains "AR") "A9"
else if(trim($."Motief") as String contains "AV") "A9"
else if(trim($."Motief") as String contains "RN") "OO"
else if(trim($."Motief") as String contains "XN") "OO"
else if(trim($."Motief") as String contains "NL") "AP"
else if(trim($."Motief") as String contains "NM") "AP"
else if(trim($."Motief") as String contains "NS") "AP"
else if(trim($."Motief") as String contains "RF") "AP"
else if(trim($."Motief") as String contains "RG") "AP"
else if(trim($."Motief") as String contains "RM") "AP"
else if(trim($."Motief") as String contains "RS") "AP"
else if(trim($."Motief") as String contains "RT") "AP"
else if(trim($."Motief") as String contains "RX") "AP"
else if(trim($."Motief") as String contains "RY") "AP"
else if(trim($."Motief") as String contains "RZ") "AP"
else if(trim($."Motief") as String contains "XH") "J1"
else if(trim($."Motief") as String contains "ZC") "PR"
else if(trim($."Motief") as String contains "CX") "AP"
else if(trim($."Motief") as String contains "RE") "AP"
else if(trim($."Motief") as String contains "CB") "AV"
else if(trim($."Motief") as String contains "CC") "AV"
else if(trim($."Motief") as String contains "CD") "AV"
else if(trim($."Motief") as String contains "CE") "AV"
else if(trim($."Motief") as String contains "CP") "AV"
else if(trim($."Motief") as String contains "AA") "X6"
else if(trim($."Motief") as String contains "AB") "X6"
else if(trim($."Motief") as String contains "AC") "X6"
else if(trim($."Motief") as String contains "AD") "X6"
else if(trim($."Motief") as String contains "AE") "X6"
else if(trim($."Motief") as String contains "AF") "X6"
else if(trim($."Motief") as String contains "AG") "X6"
else if(trim($."Motief") as String contains "AH") "X6"
else if(trim($."Motief") as String contains "AJ") "X6"
else if(trim($."Motief") as String contains "AK") "X6"
else if(trim($."Motief") as String contains "AO") "X6"
else if(trim($."Motief") as String contains "AS") "X6"
else if(trim($."Motief") as String contains "AT") "X6"
else if(trim($."Motief") as String contains "AX") "X6"
else if(trim($."Motief") as String contains "AY") "X6"
else if(trim($."Motief") as String contains "AZ") "X6"
else if(trim($."Motief") as String contains "BA") "X6"
else if(trim($."Motief") as String contains "BB") "X6"
else if(trim($."Motief") as String contains "BI") "X6"
else if(trim($."Motief") as String contains "BO") "X6"
else if(trim($."Motief") as String contains "BX") "X6"
else if(trim($."Motief") as String contains "ET") "X6"
else if(trim($."Motief") as String contains "WC") "X6"
else if(trim($."Motief") as String contains "WE") "X6"
else if(trim($."Motief") as String contains "WR") "X6"
else if(trim($."Motief") as String contains "WW") "X6"
else if(trim($."Motief") as String contains "HS") "A9"
else if(trim($."Motief") as String contains "WM") "A9"
else if(trim($."Motief") as String contains "XM") "A9"
else if(trim($."Motief") as String contains "GC") "X2"
else if(trim($."Motief") as String contains "GD") "X2"
else if(trim($."Motief") as String contains "GI") "X2"
else if(trim($."Motief") as String contains "HB") "X2"
else if(trim($."Motief") as String contains "HC") "X2"
else if(trim($."Motief") as String contains "KA") "X2"
else if(trim($."Motief") as String contains "KZ") "X2"
else if(trim($."Motief") as String contains "PA") "X2"
else if(trim($."Motief") as String contains "PC") "X2"
else if(trim($."Motief") as String contains "PD") "X2"
else if(trim($."Motief") as String contains "PF") "X2"
else if(trim($."Motief") as String contains "PH") "X2"
else if(trim($."Motief") as String contains "PI") "X2"
else if(trim($."Motief") as String contains "PJ") "X2"
else if(trim($."Motief") as String contains "PL") "X2"
else if(trim($."Motief") as String contains "PM") "X2"
else if(trim($."Motief") as String contains "PX") "X2"
else if(trim($."Motief") as String contains "PY") "X2"
else if(trim($."Motief") as String contains "QR") "X2"
else if(trim($."Motief") as String contains "SA") "X2"
else if(trim($."Motief") as String contains "SB") "X2"
else if(trim($."Motief") as String contains "SC") "X2"
else if(trim($."Motief") as String contains "SD") "X2"
else if(trim($."Motief") as String contains "SF") "X2"
else if(trim($."Motief") as String contains "SG") "X2"
else if(trim($."Motief") as String contains "SH") "X2"
else if(trim($."Motief") as String contains "SI") "X2"
else if(trim($."Motief") as String contains "SJ") "X2"
else if(trim($."Motief") as String contains "SK") "X2"
else if(trim($."Motief") as String contains "SM") "X2"
else if(trim($."Motief") as String contains "SU") "X2"
else if(trim($."Motief") as String contains "SV") "X2"
else if(trim($."Motief") as String contains "SX") "X2"
else if(trim($."Motief") as String contains "SY") "X2"
else if(trim($."Motief") as String contains "WA") "X2"
else if(trim($."Motief") as String contains "WB") "X2"
else if(trim($."Motief") as String contains "WD") "X2"
else if(trim($."Motief") as String contains "WG") "X2"
else if(trim($."Motief") as String contains "WX") "X2"
else if(trim($."Motief") as String contains "WZ") "X2"
else if(trim($."Motief") as String contains "Z0") "X2"
else if(trim($."Motief") as String contains "Z1") "X2"
else if(trim($."Motief") as String contains "Z2") "X2"
else if(trim($."Motief") as String contains "Z3") "X2"
else if(trim($."Motief") as String contains "Z4") "X2"
else if(trim($."Motief") as String contains "Z5") "X2"
else if(trim($."Motief") as String contains "Z6") "X2"
else if(trim($."Motief") as String contains "Z7") "X2"
else if(trim($."Motief") as String contains "Z8") "X2"
else if(trim($."Motief") as String contains "Z9") "X2"
else if(trim($."Motief") as String contains "ZD") "X2"
else if(trim($."Motief") as String contains "ZF") "X2"
else if(trim($."Motief") as String contains "ZI") "X2"
else if(trim($."Motief") as String contains "ZK") "X2"
else if(trim($."Motief") as String contains "ZR") "X2"
else if(trim($."Motief") as String contains "ZT") "X2"
else if(trim($."Motief") as String contains "ZX") "X2"
else if(trim($."Motief") as String contains "ZZ") "X2"
else if(trim($."Motief") as String contains "XR") "A3"
else "IO") if !(isEmpty(trim($."Motief"))),
	(statusDescription: if(trim($."Motief") as String contains "XB") "Load Cancelled"
else if(trim($."Motief") as String contains "AN") "Picked Up"
else if(trim($."Motief") as String contains "TI") "Picked Up"
else if(trim($."Motief") as String contains "LA") "Delivered"
else if(trim($."Motief") as String contains "LB") "Delivered"
else if(trim($."Motief") as String contains "LC") "Delivered"
else if(trim($."Motief") as String contains "LE") "Delivered"
else if(trim($."Motief") as String contains "LH") "Delivered"
else if(trim($."Motief") as String contains "LI") "Delivered"
else if(trim($."Motief") as String contains "LM") "Delivered"
else if(trim($."Motief") as String contains "LN") "Delivered"
else if(trim($."Motief") as String contains "LO") "Delivered"
else if(trim($."Motief") as String contains "LP") "Delivered"
else if(trim($."Motief") as String contains "LR") "Delivered"
else if(trim($."Motief") as String contains "LS") "Delivered"
else if(trim($."Motief") as String contains "XV") "Load Cancelled"
else if(trim($."Motief") as String contains "XD") "Load Cancelled"
else if(trim($."Motief") as String contains "XE") "Load Cancelled"
else if(trim($."Motief") as String contains "XF") "Load Cancelled"
else if(trim($."Motief") as String contains "XV") "Load Cancelled"
else if(trim($."Motief") as String contains "XW") "Load Cancelled"
else if(trim($."Motief") as String contains "XX") "Load Cancelled"
else if(trim($."Motief") as String contains "AI") "Load Damaged"
else if(trim($."Motief") as String contains "AM") "Load Damaged"
else if(trim($."Motief") as String contains "AP") "Load Damaged"
else if(trim($."Motief") as String contains "AQ") "Load Damaged"
else if(trim($."Motief") as String contains "AR") "Load Damaged"
else if(trim($."Motief") as String contains "AV") "Load Damaged"
else if(trim($."Motief") as String contains "RN") "Shipment Not Received"
else if(trim($."Motief") as String contains "XN") "Shipment Not Received"
else if(trim($."Motief") as String contains "NL") "Delivery Not Completed"
else if(trim($."Motief") as String contains "NM") "Delivery Not Completed"
else if(trim($."Motief") as String contains "NS") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RF") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RG") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RM") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RS") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RT") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RX") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RY") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RZ") "Delivery Not Completed"
else if(trim($."Motief") as String contains "XH") "Delivered To Connecting Line"
else if(trim($."Motief") as String contains "ZC") "Customs Hold"
else if(trim($."Motief") as String contains "CX") "Delivery Not Completed"
else if(trim($."Motief") as String contains "RE") "Delivery Not Completed"
else if(trim($."Motief") as String contains "CB") "Available For Delivery"
else if(trim($."Motief") as String contains "CC") "Available For Delivery"
else if(trim($."Motief") as String contains "CD") "Available For Delivery"
else if(trim($."Motief") as String contains "CE") "Available For Delivery"
else if(trim($."Motief") as String contains "CP") "Available For Delivery"
else if(trim($."Motief") as String contains "AA") "In Transit"
else if(trim($."Motief") as String contains "AB") "In Transit"
else if(trim($."Motief") as String contains "AC") "In Transit"
else if(trim($."Motief") as String contains "AD") "In Transit"
else if(trim($."Motief") as String contains "AE") "In Transit"
else if(trim($."Motief") as String contains "AF") "In Transit"
else if(trim($."Motief") as String contains "AG") "In Transit"
else if(trim($."Motief") as String contains "AH") "In Transit"
else if(trim($."Motief") as String contains "AJ") "In Transit"
else if(trim($."Motief") as String contains "AK") "In Transit"
else if(trim($."Motief") as String contains "AO") "In Transit"
else if(trim($."Motief") as String contains "AS") "In Transit"
else if(trim($."Motief") as String contains "AT") "In Transit"
else if(trim($."Motief") as String contains "AX") "In Transit"
else if(trim($."Motief") as String contains "AY") "In Transit"
else if(trim($."Motief") as String contains "AZ") "In Transit"
else if(trim($."Motief") as String contains "BA") "In Transit"
else if(trim($."Motief") as String contains "BB") "In Transit"
else if(trim($."Motief") as String contains "BI") "In Transit"
else if(trim($."Motief") as String contains "BO") "In Transit"
else if(trim($."Motief") as String contains "BX") "In Transit"
else if(trim($."Motief") as String contains "ET") "In Transit"
else if(trim($."Motief") as String contains "WC") "In Transit"
else if(trim($."Motief") as String contains "WE") "In Transit"
else if(trim($."Motief") as String contains "WR") "In Transit"
else if(trim($."Motief") as String contains "WW") "In Transit"
else if(trim($."Motief") as String contains "HS") "Load Damaged"
else if(trim($."Motief") as String contains "WM") "Load Damaged"
else if(trim($."Motief") as String contains "XM") "Load Damaged"
else if(trim($."Motief") as String contains "GC") "Delayed"
else if(trim($."Motief") as String contains "GD") "Delayed"
else if(trim($."Motief") as String contains "GI") "Delayed"
else if(trim($."Motief") as String contains "HB") "Delayed"
else if(trim($."Motief") as String contains "HC") "Delayed"
else if(trim($."Motief") as String contains "KA") "Delayed"
else if(trim($."Motief") as String contains "KZ") "Delayed"
else if(trim($."Motief") as String contains "PA") "Delayed"
else if(trim($."Motief") as String contains "PC") "Delayed"
else if(trim($."Motief") as String contains "PD") "Delayed"
else if(trim($."Motief") as String contains "PF") "Delayed"
else if(trim($."Motief") as String contains "PH") "Delayed"
else if(trim($."Motief") as String contains "PI") "Delayed"
else if(trim($."Motief") as String contains "PJ") "Delayed"
else if(trim($."Motief") as String contains "PL") "Delayed"
else if(trim($."Motief") as String contains "PM") "Delayed"
else if(trim($."Motief") as String contains "PX") "Delayed"
else if(trim($."Motief") as String contains "PY") "Delayed"
else if(trim($."Motief") as String contains "QR") "Delayed"
else if(trim($."Motief") as String contains "SA") "Delayed"
else if(trim($."Motief") as String contains "SB") "Delayed"
else if(trim($."Motief") as String contains "SC") "Delayed"
else if(trim($."Motief") as String contains "SD") "Delayed"
else if(trim($."Motief") as String contains "SF") "Delayed"
else if(trim($."Motief") as String contains "SG") "Delayed"
else if(trim($."Motief") as String contains "SH") "Delayed"
else if(trim($."Motief") as String contains "SI") "Delayed"
else if(trim($."Motief") as String contains "SJ") "Delayed"
else if(trim($."Motief") as String contains "SK") "Delayed"
else if(trim($."Motief") as String contains "SM") "Delayed"
else if(trim($."Motief") as String contains "SU") "Delayed"
else if(trim($."Motief") as String contains "SV") "Delayed"
else if(trim($."Motief") as String contains "SX") "Delayed"
else if(trim($."Motief") as String contains "SY") "Delayed"
else if(trim($."Motief") as String contains "WA") "Delayed"
else if(trim($."Motief") as String contains "WB") "Delayed"
else if(trim($."Motief") as String contains "Z0") "Delayed"
else if(trim($."Motief") as String contains "WG") "Delayed"
else if(trim($."Motief") as String contains "WX") "Delayed"
else if(trim($."Motief") as String contains "WZ") "Delayed"
else if(trim($."Motief") as String contains "Z0") "Delayed"
else if(trim($."Motief") as String contains "Z1") "Delayed"
else if(trim($."Motief") as String contains "Z2") "Delayed"
else if(trim($."Motief") as String contains "Z3") "Delayed"
else if(trim($."Motief") as String contains "Z4") "Delayed"
else if(trim($."Motief") as String contains "Z5") "Delayed"
else if(trim($."Motief") as String contains "Z6") "Delayed"
else if(trim($."Motief") as String contains "Z7") "Delayed"
else if(trim($."Motief") as String contains "Z8") "Delayed"
else if(trim($."Motief") as String contains "Z9") "Delayed"
else if(trim($."Motief") as String contains "ZD") "Delayed"
else if(trim($."Motief") as String contains "ZF") "Delayed"
else if(trim($."Motief") as String contains "ZI") "Delayed"
else if(trim($."Motief") as String contains "ZK") "Delayed"
else if(trim($."Motief") as String contains "ZR") "Delayed"
else if(trim($."Motief") as String contains "ZT") "Delayed"
else if(trim($."Motief") as String contains "ZX") "Delayed"
else if(trim($."Motief") as String contains "ZZ") "Delayed"
else if(trim($."Motief") as String contains "XR") "Load Returned"
else "Other") if !(isEmpty(trim($."Motief"))),
	(locatedAt: 
                if( trim($."Datum status") as String contains "/") 
	       "20"  ++ ((trim($."Datum status") as String)[6 to 7]) as String ++ "-" 
		   ++ ((trim($."Datum status") as String)[3 to 4]) as String 
		   ++ "-" 
		   ++ ((trim($."Datum status") as String)[0 to 1]) as String 
		   ++ "T"  ++ ((trim($."Tijd status") as String))

		   else ((trim($."Datum status") as String)[0 to 10] as String ++ (trim($."Tijd status") as String)) as String default "") if (!(isEmpty(trim($."Datum status"))) and !(isEmpty(trim($."Tijd status"))) )
}